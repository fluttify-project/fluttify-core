//////////////////////////////////////////////////////////
// GENERATED BY FLUTTIFY. DO NOT EDIT IT.
//////////////////////////////////////////////////////////

import 'dart:io';

import 'package:flutter/services.dart';
import 'package:#__current_package__#/src/android/android.export.g.dart';
import 'package:#__current_package__#/src/ios/ios.export.g.dart';

typedef Future<T> _FutureCallback<T>(List<Ref> releasePool);

Future<T> platform<T>({_FutureCallback<T> android, _FutureCallback<T> ios}) async {
  if (android != null && Platform.isAndroid) {
    final releasePool = <Ref>[];
    final result = await android(releasePool);
    releasePool..forEach((it) => ObjectFactory_Android.release(it))..clear();
    return result;
  } else if (ios != null && Platform.isIOS) {
    final releasePool = <Ref>[];
    final result = await ios(releasePool);
    releasePool..forEach((it) => ObjectFactory_iOS.release(it))..clear();
    return result;
  } else {
    return Future.value();
  }
}

Future release(Ref ref) {
  return platform(
    android: (pool) => ObjectFactory_Android.release(ref),
    ios: (pool) => ObjectFactory_iOS.release(ref),
  );
}

Future<void> performSelectorWithObject(Ref ref, String selector, Object object) {
  return MethodChannel('#__method_channel__#').invokeMethod('Ref::performSelectorWithObject', {'refId': ref.refId, 'selector': selector, 'object': object});
}
